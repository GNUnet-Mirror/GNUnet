# Last Modified: Mon Jul 20 11:20:57 2015
#include <tunables/global>
#include <tunables/gnunet>

profile @{GNUNET_PREFIX}/lib/gnunet/libexec/gnunet-service-vpn {
  #include <abstractions/gnunet-common>
  
  #Capability
  capability setuid,
  capability net_admin,

  /dev/net/tun rw,

  @{GNUNET_PREFIX}/lib/gnunet/libexec/gnunet-service-vpn mr,

  #Librairies
  /usr/lib/ld-*.so r,

  #Gnunet helper
  @{GNUNET_PREFIX}/lib/gnunet/libexec/gnunet-helper-vpn Px,
  
  #Gnunet librairies
  @{GNUNET_PREFIX}/lib/libgnunetcadet.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetmesh.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetregex.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetstatistics.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunettun.so.* mr,
}
