# Last Modified: Wed Jul  8 10:52:48 2015

#include <tunables/global>
#include <tunables/gnunet>

profile @{GNUNET_PREFIX}/lib/gnunet/libexec/gnunet-service-fs {
  #include <abstractions/gnunet-common>

  /etc/gnunet.conf r,
  @{HOME}/.config/gnunet.conf r,

  /tmp/gnunet-system-runtime/gnunet-service-fs.sock w,

  /var/lib/gnunet/.local/share/gnunet/private_key.ecc rk,

  owner @{HOME}/.local/share/gnunet/fs/idxinfo.lst r,

  #Librairies
  /usr/lib/ld-*.so r,
  /usr/lib/libbz2.so.* mr,
  /usr/lib/libextractor.so.* mr,
  /usr/lib/libidn.so.* mr,
  /usr/lib/libpthread-*.so mr,
  /usr/lib/librt-*.so mr,

  @{GNUNET_PREFIX}/lib/gnunet/libexec/gnunet-service-fs mr,

  #Gnunet plugin
  @{GNUNET_PREFIX}/lib/gnunet/ r,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_dht.la r,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_dht.so mr,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_dns.la r,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_dns.so mr,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_fs.la r,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_fs.so mr,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_gns.la r,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_gns.so mr,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_regex.la r,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_regex.so mr,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_template.la r,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_template.so mr,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_test.la r,
  @{GNUNET_PREFIX}/lib/gnunet/libgnunet_plugin_block_test.so mr,

  #Gnunet librairies
  @{GNUNET_PREFIX}/lib/libgnunetats.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetblock.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetcadet.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetcore.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetdatastore.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetdht.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetdnsparser.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetfs.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetgnsrecord.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunethello.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetmesh.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetpeerstore.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetregexblock.so.* mr,
  @{GNUNET_PREFIX}/lib/libgnunetstatistics.so.* mr,
}
